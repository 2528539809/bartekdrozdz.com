!function(e){e.Data=function(){var e,t={},n=function(){var t,n={};for(n.projects=[],n.play=[],t=0;t<e.projects.length;t++){var i=e.projects[t];i.hidden||n.projects.push(i)}return n};return t.setMain=function(t){e=t},t.getMain=function(){var t=n();return t.conferences=e.conferences,t.publications=e.publications,t},t.toFilteredJSON=function(){var t={};return t.projects=e.projects,t.play=e.play,JSON.stringify(t)},t.getProjectById=function(t){t=t.indexOf("?")>-1?t.split("?")[0]:t;var n,i,r=e.projects.length;for(i=0;r>i;i++)if(n=e.projects[i],n.id==t)return n},t}()}("undefined"!=typeof process&&process.versions?exports:window);var Framework={version:"0.1",build:28,date:"2014-08-22T19:01:18.298Z"};window.Simplrz=function(){var e={},t=["js"],n=function(n,i){var r=i();e[n]=r?!0:!1,t.push(r?n:"no-"+n),document.documentElement.setAttribute("class",t.join(" "))};e.pixelRatio=window.devicePixelRatio||1;var i=function(){var e="",t="",n="";return window.getComputedStyle&&(e=window.getComputedStyle(document.documentElement,""),t=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1],n="WebKit|Moz|MS|O".match(new RegExp("("+t+")","i"))[1]),{dom:n,lowercase:t,css:"-"+t+"-",js:""==t?"":t[0].toUpperCase()+t.substr(1)}}();e.prefix=i,t.push(i.lowercase),e.prefixedProp=function(e){switch(i.lowercase){case"webkit":return"webkit"+e.charAt(0).toUpperCase()+e.slice(1);case"ms":return"-ms-"+e;case"moz":return"Moz"+e.charAt(0).toUpperCase()+e.slice(1);default:return i.css+e}};var r=function(){for(var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0];);return e>4?e:null}();if(null==r){var o=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),a=navigator.userAgent,s=a.match(o);r=s&&s.length>1?parseInt(s[1]):null}return e.ie=r||!1,t.push(r?"ie-"+r:"no-ie"),e.firefox="moz"==i.lowercase,t.push(e.firefox?"firefox":"no-firefox"),e.safariDesktop=navigator.userAgent.match(/Safari/)&&!navigator.userAgent.match(/Chrome/)&&!("ontouchstart"in document),t.push(e.safariDesktop?"safari-desktop":"no-safari-desktop"),e.ipad7=navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)||!1,t.push(e.ipad7?"ipad7":"no-ipad7"),n("css3d",function(){if("webkit"==i.lowercase||"moz"==i.lowercase)return!0;if("ms"==i.lowercase){var e=document.createElement("div");e.style[i.css+"transform"]="translateZ(0px)";var t=getComputedStyle(e),n=t.getPropertyValue(i.css+"transform");return n&&""!=n&&"none"!=n}return!1}),n("csstransitions",function(){return!r||r>=10}),n("cssanimations",function(){return!r||r>=10}),n("css2d",function(){return!r||r>=9}),n("touch",function(){return"ontouchstart"in document}),n("pointer",function(){return navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>1}),n("canvas",function(){try{var e=document.createElement("canvas");return e.getContext("2d")}catch(t){return!1}}),n("history",function(){return!(!window.history||!history.pushState)}),n("webrtc",function(){return"getUserMedia"in navigator||"webkitGetUserMedia"in navigator}),n("webgl",function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}),e.classes=t,e}(),Events=function(e,t){var n,i,r=e||{},o={},a={},s=[],c=[];return r.on=function(e,t,n){o[e]||(o[e]=[]),o[e].push(t),n&&(a[t]=n)},r.off=function(e,t,i){i?(s.push(arguments),n=s.length):o[e]&&o[e].splice(t,1)},t||(r.offAll=function(e,t){for(var n=o[e],i=ex.length,a=0;i>a;a++)r.off(e,n[a],t)}),r.trigger=function(e,t,u){if(u)return c.push(arguments),void(i=c.length);if(o[e])for(var l=0,d=o[e].length;d>l;){var f=o[e][l];f.call(a[f],t),l++}if(n>0){for(var l=0;n>l;l++){var p=s[l];r.off(p[0],p[1],!1)}s=[],n=0}if(i>0){var h=c.shift();i=c.length,r.trigger(h[0],h[1])}},r},Application=function(e){var t,n=Events({},!0);return n.init=function(){t=HistoryRouter(n),t.init(),e.addEventListener("resize",function(e){n.trigger(MSG.RESIZE,e)}),e.addEventListener("orientationchange",function(e){n.trigger(MSG.RESIZE,e)}),e.FrameImpulse&&e.Anm&&FrameImpulse.on(Anm.update)},n}(window);var DomExtend=function(){var e={};return e.create=function(t){var n=document.createElement(t);return e.extend(n),n},e.select=function(t,n){var i=(n||document).querySelector(t);return i&&!i.ext&&e.extend(i),i},e.selectAll=function(t,n){for(var i=(n||document).querySelectorAll(t),r=i.length,o=[],a=0;r>a;a++){var s=i[a];s.ext||(s=e.extend(s)),o.push(s)}return o},e.extend=function(t){if(!t.ext){var n={};return n.create=function(t){return e.create(t)},n.select=function(n){return e.select(n,t)},n.selectAll=function(n){return e.selectAll(n,t)},window.State&&State(n,t),window.Transform&&Transform(n,t),window.Transition&&Transition(n,t),n.element=t,t.ext=n,t}},e.extend(document),window.EXT=e,e}();State=function(e,t){var n=function(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})};e.data={},e.show=function(e){t.style.display=e||"block"},e.hide=function(){t.style.display="none"},e.visible=function(){return"none"!=e.readCss("display")},e.on=function(e,n,i){return t.addEventListener(e,n,i)},e.off=function(e,n,i){return t.removeEventListener(e,n,i)},e.css=function(e,i){if("string"==typeof e)t.style[n(e)]=i;else for(var r in e)t.style[n(e)]=e[r]},e.readCss=function(e,n){return n?t.style[e]:getComputedStyle(t).getPropertyValue(e)},e.attr=function(e,n){return void 0!=n&&t.setAttribute(e,n),t.getAttribute(e)}},Transform=function(e,t){var n=!1,i={width:0,height:0,top:0,left:0};e.rect=function(){try{return t.getBoundingClientRect()}catch(e){return console.log(e.stack),i}},e.width=function(n){return n?(t.style.width=n+"px",n):e.rect().width},e.height=function(n){return n?(t.style.height=n+"px",n):e.rect().height},e.x=0,e.y=0,e.z=0,e.rotX=0,e.rotY=0,e.rotZ=0,e.scaleX=1,e.scaleY=1,e.scaleZ=1,e.transformToString=function(t){t=t||e;var i="";return t.x&&(i+="translateX("+t.x+"px) "),t.y&&(i+="translateY("+t.y+"px) "),Simplrz.css3d&&!n&&(i+="translateZ("+t.z+"px) "),t.rotX&&Simplrz.css3d&&(i+="rotateX("+t.rotX+"deg)  "),t.rotY&&Simplrz.css3d&&(i+="rotateY("+t.rotY+"deg)"),t.rotZ&&Simplrz.css3d?i+="rotateZ("+t.rotZ+"deg) ":t.rotZ&&(i+="rotate("+t.rotZ+"deg) "),1!=t.scaleX&&(i+="scaleX("+t.scaleX+") "),1!=t.scaleY&&(i+="scaleY("+t.scaleY+") "),1!=t.scaleZ&&Simplrz.css3d&&(i+="scaleZ("+t.scaleZ+")"),i},e.transform=function(i){if(i)for(var r in i)e[r]=i[r];var o=e.transformToString(e,n);t.style[Simplrz.prefixedProp("transform")]=o,t.style.transform=o}},Transition=function(e,t){var n={transition:"transitionEnd",Moz:"transitionend",O:"oTransitionEnd",Webkit:"webkitTransitionEnd",Ms:"MSTransitionEnd"},i=n[Simplrz.prefix.js],r="transform",o=function(){return(new Date).getTime()};e.createTransition=function(){function n(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}var a,s,c,u,l={},d=[],f=[],p=0,h=function(){if(s--,0>=s){var e=o()-c;e>=p?m():u||(setTimeout(m,e),u=!0)}},m=function(){l.clear(),a&&a()},v=function(n){for(var i=n.length,o=0;i>o;o++){var a=n[o][0],s=n[o][1];a==r?e.transform(s):t.style[a]=s}return l};return l.add=function(e,t,i,r,o){return p=Math.max(p,i),r=r||Util.cssEase.ease,o=o||0,d.push([n(e),i+"ms",r,o+"ms"].join(" ")),f.push([e,t]),l},l.trs=function(e,t,n,i){return p=Math.max(p,t),n=n||Util.cssEase.ease,i=i||0,d.push([Simplrz.prefix.css+"transform",t+"ms",n,i+"ms"].join(" ")),f.push([r,e]),l},l.clear=function(){t.removeEventListener(i,h),d=[],f=[],t.style[Simplrz.prefix.js+"Transition"]="",t.style.transition=""},l.start=function(e){return a=e,s=f.length,t.addEventListener(i,h),setTimeout(function(){c=o(),u=!1,t.style[Simplrz.prefix.js+"Transition"]=d,t.style.transition=d,v(f)},0),l},l.then=function(t){var n=e.createTransition(),i=function(){t(),n.start()};return l.start(i),n},l},e.transition=function(t,n,i,o,a){var s=e.createTransition();for(var c in t){var u=t[c];c==r?s.trs(u,n,i,o):s.add(c,u,n,i,o)}return s.start(a),s}},FrameImpulse=function(){var e,t,n=["webkit","moz"],i=0,r=0,o=0,a=16,s=60,c=60,u=1e3,l={},d=[],f=0,p=[];l.fps=60;for(var h=0;h<n.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[n[h]+"RequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-i)),r=window.setTimeout(function(){e(t+n)},n);return i=t+n,r});var m=function(t){r++;var n=t-i;isNaN(n)&&(n=1e3/60),i=t,o+=n,a=(n+a*(u-1))/u,s=1e3/a,c=Math.min(s,c),l.fps=isNaN(s)||!s?60:s,l.fpsNow=1e3/n,l.fpsLow=c,e&&(e.innerHTML=a>20?"<b>"+(0|s)+"</b> | "+(0|a):(0|s)+" | "+(0|a))},v=function(e){if(requestAnimationFrame(v),m(e),0!=f){for(var n=0;f>n;n++)d[n].call(e);if(t>0){for(var n=0;t>n;n++)d.splice(p[n],1);f=d.length,p=[],t=0}}};return l.on=function(e){d.indexOf(e)>-1||(d.push(e),f=d.length)},l.off=function(e){p.push(e),t=p.length},l.getListeners=function(){return d},v(),l}(),HistoryRouter=function(e){var t=document.location.protocol+"//"+(document.location.hostname||document.location.host);document.location.port&&(t+=":"+document.location.port);var n,i,r=function(){if(Simplrz.history)for(var e="a[href]",t=EXT.selectAll(e),n=0;n<t.length;n++){var i=t[n],r=i.ext.attr("href"),o=i.ext.attr("target"),a=i.ext.attr("data-hj");if(!(r.indexOf(":")>-1||"_blank"==o||"no"==a||i.hijacked)){i.hijacked=!0;var c=function(e){e&&e.preventDefault(),s(this.href)};Simplrz.touch?Util.handleTap(i,c):i.addEventListener("click",c)}}},o=!1,a=function(){var r=n.substring(t.length),o=r.split("/");o.shift(),e.trigger(MSG.ROUTE,{route:r,parts:o,prevRoute:i})},s=function(e){Simplrz.history&&history.pushState(null,null,e),i=n?n.replace(t,""):null,n=document.location.href,a()};return window.addEventListener("popstate",function(){o=!0,i=n?n.replace(t,""):null,n=document.location.href,a()}),e.on(MSG.HIJACK_LINKS,r),e.on(MSG.NAVIGATE,s),setTimeout(function(){o?console.log("History initiated, no manual push."):s()},20,document.location.href),{init:function(){r()}}},window.Loader={loadText:function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){4==n.readyState&&t.call(null,n.responseText)},n.send()},loadJSON:function(e,t){Loader.loadText(e,function(e){t(JSON.parse(e))})},loadImage:function(e,t){var n=new Image;n.onload=t(n),n.src=e}},MSG={ROUTE:"route",RESIZE:"resize",HIJACK_LINKS:"hijack-links",NAVIGATE:"navigate"};var VirtualScroll=function(e){var t,n,i,r,o={},a=[],s=!1,c=2,u=15,l=120,d=1,f="onwheel"in e,p="onmousewheel"in e,h="ontouchstart"in e,m=navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>1,v=!!window.navigator.msPointerEnabled,g="onkeydown"in e,x=navigator.userAgent.indexOf("Firefox")>-1,w={y:0,x:0,deltaX:0,deltaY:0,originalEvent:null};o.on=function(e){s||z(),a.push(e),t=a.length},o.options=function(e){l=e.keyStep||120,u=e.firefoxMult||15,c=e.touchMult||2,d=e.mouseMult||1},o.off=function(e){a.splice(e,1),t=a.length,0>=t&&k()};var b=function(e){w.x+=w.deltaX,w.y+=w.deltaY,w.originalEvent=e;for(var n=0;t>n;n++)a[n](w)},T=function(e){w.deltaX=e.wheelDeltaX||-1*e.deltaX,w.deltaY=e.wheelDeltaY||-1*e.deltaY,x&&1==e.deltaMode&&(w.deltaX*=u,w.deltaY*=u),w.deltaX*=d,w.deltaY*=d,b(e)},y=function(e){w.deltaX=e.wheelDeltaX?e.wheelDeltaX:0,w.deltaY=e.wheelDeltaY?e.wheelDeltaY:e.wheelDelta,b(e)},S=function(e){var t=e.targetTouches?e.targetTouches[0]:e;n=t.pageX,i=t.pageY},E=function(e){var t=e.targetTouches?e.targetTouches[0]:e;w.deltaX=(t.pageX-n)*c,w.deltaY=(t.pageY-i)*c,n=t.pageX,i=t.pageY,b(e)},M=function(e){switch(w.deltaX=w.deltaY=0,e.keyCode){case 37:w.deltaX=-l;break;case 39:w.deltaX=l;break;case 38:w.deltaY=l;break;case 40:w.deltaY=-l}b(e)},z=function(){f&&e.addEventListener("wheel",T),p&&e.addEventListener("mousewheel",y),h&&(e.addEventListener("touchstart",S),e.addEventListener("touchmove",E)),v&&m&&(r=e.body.style.msTouchAction,e.body.style.msTouchAction="none",e.addEventListener("MSPointerDown",S,!0),e.addEventListener("MSPointerMove",E,!0)),g&&e.addEventListener("keydown",M),s=!0},k=function(){f&&e.removeEventListener("wheel",T),p&&e.removeEventListener("mousewheel",y),h&&(e.removeEventListener("touchstart",S),e.removeEventListener("touchmove",E)),v&&m&&(e.body.style.msTouchAction=r,e.removeEventListener("MSPointerDown",S,!0),e.removeEventListener("MSPointerMove",E,!0)),g&&e.removeEventListener("keydown",M),s=!1};return o}(document);Pointer=function(){var e={x:0,y:0};return Simplrz.touch?document.addEventListener("touchmove",function(t){var n=t.targetTouches?t.targetTouches[0]:t;e.x=n.pageX,e.y=n.pageY}):document.addEventListener("mousemove",function(t){e.x=t.pageX,e.y=t.pageY}),e}(),Math.clamp=function(e,t,n){return t>e?t:e>n?n:e},Math.clamp01=function(e){return 0>e?0:e>1?1:e},Math.pointInRect=function(e,t){return e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom},Math.randomBtwn=function(e,t){return e+Math.random()*(t-e)},Math.norm=function(e,t,n){return(e-t)/(n-t)},Math.map=function(e,t,n,i,r){return Math.lerp(i,r,Math.norm(e,t,n))},Math.lerp=function(e,t,n){return e+(t-e)*n},Math.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},Util={handleTap:function(e,t){var n=function(){var n,i,r,o={},a=2e4,s=100,c=e,u=t;return o.click=function(e){e.preventDefault()},o.touchStart=function(e){e.preventDefault(),n=(new Date).getTime(),i=e.targetTouches[0].pageX,r=e.targetTouches[0].pageY},o.touchEnd=function(e){e.preventDefault();var t=(new Date).getTime()-n,o=e.changedTouches[0].pageX-i,l=e.changedTouches[0].pageY-r,d=o*o+l*l;a>t&&s>d&&u.apply(c)},o}();return e.addEventListener("touchstart",n.touchStart),e.addEventListener("touchend",n.touchEnd),e.addEventListener("click",n.click),n},delay:function(e,t,n){t=t||0,setTimeout(function(){e.apply(n)},t)},debounce:function(e,t){var n,i,r,o,a;return function(){r=this,i=arguments,o=Date.now();var s=function(){var e=Date.now()-o;n=t>e?setTimeout(s,t-e):null};return n||(n=setTimeout(s,t),a=e.apply(r,i),r=i=null),a}},cssEase:{ease:"ease",smoothstep:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"}},Easer=function(e){var t=e||1,n=0,i=0,r=-1e8,o=1e9,a={velocity:0};return a.setTarget=function(e){i=e},a.getTarget=function(){return i},a.updateTarget=function(e){i+=e},a.setLimits=function(e,t){r=e,o=t},a.easeVal=function(){return i=Math.clamp(i,r,o),a.velocity=(i-n)*t,n+=a.velocity},a.setEase=function(e){t=e},a.reset=function(e){n=e||0,i=e||0},a.toString=function(){return"min: "+r+" / max: "+o+" / target: "+i+" / pos: "+n},a},Timing={pageTransition:function(){return Math.clamp(.5*window.innerWidth,400,800)}},window.Site=function(e){Simplrz.touch&&document.addEventListener("touchmove",function(e){e.preventDefault()}),Data.setMain(e),Application.init(),Main(),About(),Content()},Site.CDN="http://cdn.bartekdrozdz.com/",Site.MAIN="",Site.ABOUT="about",Site.PROJECT="project",Site.ARTICLE="article",Main=function(){var e=!1,t=EXT.select("#main"),n=t.ext.select(".header"),i=(EXT.select("#projects"),EXT.selectAll(".box")),r=t.ext.select("#projects-shortcut"),o=new Easer(.1);i.forEach(function(e){Box(e)});var a=function(){var e=window.innerHeight*-.75;o.setTarget(e),i.forEach(function(t){t.box.onAutoScroll(e)})};Simplrz.touch?Util.handleTap(r,a):r.ext.on("click",a);var s=function(){var n=t.ext.height()-window.innerHeight;o.setLimits(-n,0),i.forEach(function(e){e.box.onResize(n)}),e||t.ext.transform({x:-window.innerWidth})},c=function(t){e&&o.updateTarget(t.deltaY)},u=function(){if(e){var t=o.easeVal(),i=1-Math.norm(t,-20,-100);n.ext.css("opacity",i)}},l=function(n){var i=n.parts[0],r=n.prevRoute,o=500;switch(e=i==Site.MAIN,i){case Site.MAIN:r?t.ext.transition({transform:{x:0}},Timing.pageTransition(),"ease"):t.ext.transform({x:0});break;case Site.ABOUT:r?t.ext.transition({transform:{x:o}},Timing.pageTransition(),"ease"):t.ext.transform({x:o});break;case Site.PROJECT:r?t.ext.transition({transform:{x:-window.innerWidth}},Timing.pageTransition(),"ease",0,function(){}):t.ext.transform({x:-window.innerWidth})}};VirtualScroll.on(c),FrameImpulse.on(u),Application.on(MSG.RESIZE,s),Application.on(MSG.ROUTE,l),s()};var Box=function(e){var t=!1,n=e.ext,i=n.attr("data-id"),r=!1,o=!0,a=new Easer,s=0;a.setEase(.5);var c=e.ext.rect(),u=e.ext.rect().top,l=0,d=n.select(".container");if(i){var f=Data.getProjectById(i),p=n.select(".mask"),h=n.select("img"),r=!1;p.ext.css("backgroundColor",f.tint);var m=window.innerWidth>768||!Simplrz.touch,v="demo"==f.type?"400sq":"675sq",g="demo"==f.type?"200sq":"320sq",x=m?v:g,w=Site.CDN+"assets/content/%f%/%id%.jpg".replace("%f%",x).replace("%id%",f.id);h.ext.on("load",function(){p.ext.transition({backgroundColor:"rgba(0,0,0,0)"},500,"ease",0,function(){p.ext.attr("class","hover"),Util.delay(function(){p.ext.css("backgroundColor",f.tint),Simplrz.touch||d.classList.add("hovered-transition"),r=!0})})})}var b=function(){Simplrz.touch||(d.classList.remove("hovered-container"),o=!0)},T=function(){Simplrz.touch||(d.classList.add("hovered-container"),o=!1)},y=function(e){t&&(a.updateTarget(e.deltaY),s=e.deltaY/Math.abs(e.deltaY),o||b())},S=function(){if(t){!r&&h&&u+l<window.innerHeight&&(h.src=w),a.velocity<.1&&o&&r&&T();var n=Math.clamp01((u+l)/window.innerHeight),i=Math.clamp01(Math.abs(c.left+c.width/2-Pointer.x)/window.innerWidth);0>s&&(n=1-n);var d=.5*n+.5*(1-i);a.setEase(.05+.12*d),l=a.easeVal(),e.ext.transform({y:l})}},E=function(e){var n=e.parts[0];t=n==Site.MAIN,t||b()};VirtualScroll.on(y),Application.on(MSG.ROUTE,E),FrameImpulse.on(S),e.box={},e.box.onAutoScroll=function(e){a.setTarget(e)},e.box.onResize=function(t){a.setLimits(-t,0),c=e.ext.rect();var n=0|c.width,i=0|c.height;d.ext.width(n-5),d.ext.height(i-5)}};About=function(){var e=!1,t=!1,n=EXT.select("#about > div");n.ext.show();var i=new Easer(.2),r=function(){t=!0},o=function(){var e=Math.max(0,n.ext.height()-window.innerHeight);i.setLimits(-e,0)},a=function(n){e&&t&&i.updateTarget(n.deltaY)},s=function(){if(e&&t){var r=0|i.easeVal();n.ext.y=r,n.ext.transform()}},c=function(i){var o=i.parts[0],a=null==i.prevRoute,s=Math.min(500,window.innerWidth);switch(e=o==Site.ABOUT,o){case Site.ABOUT:a?t=!0:(t=!1,n.ext.transition({transform:{rotY:0,x:0},opacity:1},Timing.pageTransition(),"ease",0,r));break;default:a?(n.ext.transform({rotY:-90,x:-s}),n.ext.css("opacity",0)):(t=!1,n.ext.transition({transform:{rotY:-90,x:-s},opacity:0},Timing.pageTransition(),"ease"))}};VirtualScroll.on(a),FrameImpulse.on(s),Application.on(MSG.RESIZE,o),Application.on(MSG.ROUTE,c),o()},Content=function(){var e,t,n=!1,i=!1,r=EXT.select("#content"),o=(r.ext.select(".close"),Hero(r.ext.select(".hero"))),a=r.ext.select(".content"),s=new Easer(.2),c=function(){return"webkit"==Simplrz.prefix.lowercase&&(!Simplrz.touch||"iPhone"==navigator.platform&&568==screen.height)&&"demo"!=e.type},u=!1,l=function(){if(n){var e=a.ext.height()-window.innerHeight;s.setLimits(Math.min(o.height(),-e),o.height()),o.onResize(),d()}},d=function(e){if(n||!i){var t=e?e.deltaY:0;s.updateTarget(t)}},f=function(){if(n||!i){var e=s.easeVal();a.ext.y=e,a.ext.transform();var t=e-o.height();if(o.ext.y=.5*t,o.ext.transform(),u){var r=0|Math.clamp(t/-10,0,40);FrameImpulse.fps<45&&r>0?(a.ext.css("backgroundColor","rgba(0, 0, 0, 1)"),o.ext.css("webkitFilter",""),u=!1):o.ext.css("webkitFilter","blur("+r+"px)")}}},p=function(l){var d=l.parts[0],f=null==l.prevRoute,p=.5*window.innerWidth;switch(n=d==Site.PROJECT||d==Site.ARTICLE,n&&(e=Data.getProjectById(l.parts[1]),u=c(),u?a.ext.css("backgroundColor","rgba(0, 0, 0, 0.5)"):a.ext.css("backgroundColor","rgb(0, 0, 0)"),i=!1,a.innerHTML="",Loader.loadText("/data/"+l.parts[1],h)),d){case Site.PROJECT:case Site.ARTICLE:f?(r.ext.transform({x:0}),r.ext.css("opacity",1),o.setup(e),o.load(e)):(o.adjust(),o.setup(e),r.ext.transition({transform:{x:0},opacity:1},Timing.pageTransition(),"ease",0,function(){o.load(e)})),s.reset(o.height());break;default:t&&t.pause(),o.killIframe(),f?(r.ext.transform({x:p}),r.ext.css("opacity",0)):r.ext.transition({transform:{x:p},opacity:0},Timing.pageTransition(),"ease",0,function(){o.ext.css("webkitFilter",""),o.kill()})}},h=function(n){a.innerHTML="<h1>"+e.name+"</h1>"+n;var r=a.ext.select(".video .play");t=a.ext.select(".video video");for(var o=a.ext.selectAll(".gallery-image"),s=0;s<o.length;s++){var c=o[s];c.addEventListener("load",l)}if(r&&(r.ext.css("backgroundImage","url("+r.ext.attr("data-src")+")"),r.ext.on("click",function(){t.ext.css("display","block"),t.play(),r.ext.css("display","none")})),t&&Simplrz.touch){var u=function(){t.ext.css("display","none"),r.ext.css("display","block")};t.ext.css("display","none"),t.ext.on("pause",function(){t.webkitDisplayingFullscreen||u()}),t.ext.on("ended",function(){t.webkitDisplayingFullscreen&&(t.webkitExitFullScreen(),u())})}l(),i=!0};VirtualScroll.on(d),FrameImpulse.on(f),Application.on(MSG.RESIZE,l),Application.on(MSG.ROUTE,p)},Hero=function(e){var t,n,i={},r=2.35,o=function(){t.ext.transition({opacity:1},400,"ease-out")},a=function(){return window.innerWidth>=window.innerHeight};return i.setup=function(r){var a=[];r.deps.forEach(function(e){Simplrz[e]||a.push(e)}),n="demo"==r.type&&0==a.length,t=EXT.create(n?"iframe":"img"),t.ext.attr("frameborder",0),t.ext.css("opacity",0),e.ext.css("backgroundColor","#000"),t.ext.on("load",o),i.adjust(),e.innerHTML="",e.appendChild(t)},i.load=function(e){t||i.setup(e);var r=a()?Site.CDN+"assets/content/1920w-235as/":Site.CDN+"assets/content/871sq/";t.src=n?e.url:r+e.id+".jpg"},i.adjust=function(){var o,s,c;a()?n?(o=i.height(),s=window.innerWidth,c=0):(o=i.height(),s=o*r,c=(s-window.innerWidth)*-.5):(o=s=window.innerWidth,c=0),e.ext.height(o),t&&(t.ext.height(o),t.ext.width(s),t.ext.transform({x:c}))},i.killIframe=function(){if(t)try{t.contentWindow.kill()}catch(e){}},i.kill=function(){t&&(e.removeChild(t),t.innerHTML="",t=null)},i.height=function(){return a()?n?window.innerHeight:Math.max(window.innerWidth/r,.75*window.innerHeight):Math.min(window.innerWidth,.9*window.innerHeight)},i.onResize=function(){i.adjust()},i.ext=e.ext,i},window.addEventListener("load",function(){return Simplrz.history?(Site(rawData),void Application.on(MSG.ROUTE,function(){setTimeout(function(){ga&&ga("send","pageview")},10)})):void(document.location=document.location.href+"?ns")});